<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">
	
	<!-- 모든 게시판 조회 -->
	<select id="allBoard" resultType="boardvo">
		SELECT * FROM board_info
	</select>
	
	<!-- 모든 게시판 수 조회 -->
	<select id="allCountBoard" resultType="Integer">
		SELECT COUNT(*) FROM board_info
	</select>
	
	<!-- 활성화 된 게시판 조회 -->
	<select id="useBoard" resultType="boardvo">
		SELECT bor_nm, bor_num FROM board_info WHERE bor_act = 1
	</select>
	
	<!-- 게시판 이름 또는 상태 변경 -->
	<update id="updateBoard" parameterType="boardvo">
		UPDATE  board_info SET bor_nm = #{bor_nm}, bor_act =#{bor_act} WHERE bor_num = #{bor_num}
	</update>
	 
	<!-- 새로운 게시판 생성 -->
	<insert id="createBoardInfo" parameterType="boardvo">
		INSERT INTO board_info VALUES(#{bor_nm} , #{bor_num}, #{bor_act})
	</insert>
	
	<!-- 선택한 게시판 정보 -->
	<select id="selectboardinfo" parameterType="Integer" resultType="boardvo">
		SELECT * FROM board_info WHERE bor_num = #{bor_num}
	</select>
	
	<!-- 선택된 게시판 게시물 전체 조회 -->
	<select id="selectBoardContent" parameterType="Integer" resultType="boardpostvo">
		SELECT * FROM board_post WHERE bor_num = (SELECT bor_num FROM board_info WHERE bor_num = #{bor_num}) ORDER BY post_no DESC
	</select>
	
	<!-- 선택된 게시판 게시물 개수 -->
	<select id="selectContCount" resultType="Integer" parameterType="Integer">
		SELECT COUNT(*) FROM board_post WHERE bor_num = #{bor_num}
	</select>
	
	<!-- 새로운 게시글 생성 -->
	<insert id="newContent" parameterType="boardpostvo">
		INSERT INTO board_post VALUES(#{post_no} ,#{user_id} ,#{title} ,#{cont} ,SYSDATE ,#{post_del} ,#{lft} ,#{post_c_no},#{b_user_id}, #{bor_num})
	</insert>
	
	<!-- 최신번호 가져오기 -->
	<select id="maxNumber" parameterType="Integer" resultType="Integer">
		SELECT COUNT(*) FROM board_post WHERE bor_num =#{bor_num}
	</select>
	
	<!-- 첨부파일 저장 -->
	<insert id="attachFile" parameterType="attachvo">
		INSERT INTO attach VALUES(SEQ_FILENUM.NEXTVAL, #{post_no}, #{user_id}, #{file_nm}, #{file_path})
	</insert>
	
	<!-- 선택된 게시글 상세보기 -->
	<select id="selectBoardDetail" parameterType="boardpostvo" resultType="boardpostvo">
		SELECT * FROM board_post WHERE bor_num = #{bor_num} AND post_no = #{post_no}
	</select>
	
	<!-- 게시글 수정 -->
	<update id="modifyContent" parameterType="boardpostvo">
		UPDATE board_post SET title=#{title}, cont = #{cont} WHERE post_no = #{post_no} AND user_id = #{user_id} AND bor_num = #{bor_num}
	</update>
	
	<!-- 게시글 삭제 -->
	<update id="deleteContent" parameterType="Integer">
		UPDATE board_post SET post_del = 0 WHERE post_no = #{post_no} AND user_id = #{user_id}
	</update>
	
	
	
	<!-- 댓글 생성 -->
	
	<!-- 댓글 수정 -->
	
	<!-- 댓글 삭제 -->
	
</mapper>